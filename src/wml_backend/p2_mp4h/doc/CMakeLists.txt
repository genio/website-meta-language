SET (POD_PATH  "mp4h.pod")
SET (HTML_PATH  "mp4h.html")
SET (PROGDIR "${CMAKE_BINARY_DIR}/wml_backend/p2_mp4h/src")
SET (MYPROGRAM "${PROGDIR}/wml_p2_mp4h")
SET (MYFLAGS "-X 0 -I ${CMAKE_CURRENT_SOURCE_DIR} -D srcdir=${CMAKE_CURRENT_SOURCE_DIR}")

MACRO(PREPARE_MP4H_DOC TARGET FORMAT)
ADD_CUSTOM_COMMAND(
    OUTPUT "${TARGET}"
    COMMAND "${PERL_EXECUTABLE}"
    ARGS "${CMAKE_CURRENT_SOURCE_DIR}/myformat.pl"
        "${MYPROGRAM}"
        "${MYFLAGS}"
        "${FORMAT}"
        "${CMAKE_CURRENT_SOURCE_DIR}"
        "${TARGET}"
        DEPENDS "${CMAKE_CURRENT_SOURCE_DIR}/mp4h.mp4h" "${CMAKE_CURRENT_SOURCE_DIR}/${FORMAT}.out" "${MYPROGRAM}"
)
ENDMACRO(PREPARE_MP4H_DOC TARGET FORMAT)

PREPARE_MP4H_DOC ("${CMAKE_CURRENT_BINARY_DIR}/${POD_PATH}" "pod")
PREPARE_MP4H_DOC ("${CMAKE_CURRENT_BINARY_DIR}/${HTML_PATH}" "html")

SET (POD2MAN_SOURCE_IS_IN_BINARY 1)
INST_RENAME_POD2MAN( "mp4h_pod" "mp4h.pod" "mp4h" "1" "mp4h")
